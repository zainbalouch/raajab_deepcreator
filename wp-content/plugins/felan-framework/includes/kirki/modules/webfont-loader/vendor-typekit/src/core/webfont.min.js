goog.provide("webfont.WebFont");goog.require("webfont.DomHelper");goog.require("webfont.EventDispatcher");goog.require("webfont.FontWatcher");goog.require("webfont.FontModuleLoader");webfont.WebFont=function(o){this.mainWindow_=o;this.fontModuleLoader_=new webfont.FontModuleLoader;this.moduleLoading_=0;this.events_=true;this.classes_=true};goog.scope(function(){var o=webfont.WebFont,n=webfont.DomHelper,i=webfont.EventDispatcher,e=webfont.FontWatcher;o.prototype.addModule=function(o,e){this.fontModuleLoader_.addModuleFactory(o,e)};o.prototype.load=function(o){var e=o["context"]||this.mainWindow_;this.domHelper_=new n(this.mainWindow_,e);this.events_=o["events"]!==false;this.classes_=o["classes"]!==false;var t=new i(this.domHelper_,o);this.load_(t,o)};o.prototype.onModuleReady_=function(o,e,t,n,i){var s=--this.moduleLoading_==0;if(this.classes_||this.events_){setTimeout(function(){e.watchFonts(t,n||null,i||null,s)},0)}};o.prototype.load_=function(n,o){var e=[],t=o["timeout"],i=this;n.dispatchLoading();e=this.fontModuleLoader_.getModules(o,this.domHelper_);var s=new webfont.FontWatcher(this.domHelper_,n,t);this.moduleLoading_=e.length;for(var a=0,d=e.length;a<d;a++){var r=e[a];r.load(function(o,e,t){i.onModuleReady_(n,s,o,e,t)})}}});