goog.provide("webfont.NativeFontWatchRunner");goog.require("webfont.Font");goog.scope(function(){webfont.NativeFontWatchRunner=function(t,n,o,e,i,a){this.activeCallback_=t;this.inactiveCallback_=n;this.font_=e;this.domHelper_=o;this.timeout_=i||3e3;this.fontTestString_=a||undefined};var t=webfont.NativeFontWatchRunner;t.prototype.start=function(){var i=this.domHelper_.getLoadWindow().document,a=this;var c=goog.now();var t=new Promise(function(n,o){var e=function(){var t=goog.now();if(t-c>=a.timeout_){o()}else{i.fonts.load(a.font_.toCssString(),a.fontTestString_).then(function(t){if(t.length>=1){n()}else{setTimeout(e,25)}},function(){o()})}};e()});var o=null,n=new Promise(function(t,n){o=setTimeout(n,a.timeout_)});Promise.race([n,t]).then(function(){if(o){clearTimeout(o);o=null}a.activeCallback_(a.font_)},function(){a.inactiveCallback_(a.font_)})}});