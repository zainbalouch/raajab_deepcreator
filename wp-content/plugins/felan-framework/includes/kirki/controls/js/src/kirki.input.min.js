var kirki=kirki||{};kirki=jQuery.extend(kirki,{input:{radio:{init:function(i){var e=jQuery('input[data-id="'+i.id+'"]');e.on("change keyup paste click",function(){kirki.setting.set(i.id,jQuery(this).val())})}},color:{init:function(i){var e=jQuery('.kirki-color-control[data-id="'+i.id+'"]'),a;i.choices=i.choices||{};if(_.isEmpty(i.choices)&&i.params.choices){i.choices=i.params.choices}if(!_.isEmpty(i.choices)){e.wpColorPicker(i.choices)}setTimeout(function(){a=jQuery('.kirki-input-container[data-id="'+i.id+'"] .wp-picker-clear');if(a.length){a.click(function(){kirki.setting.set(i.id,"")})}},200);e.wpColorPicker({change:function(){setTimeout(function(){kirki.setting.set(i.id,e.val())},20)}})}},genericInput:{init:function(i){var e=jQuery('input[data-id="'+i.id+'"]');e.on("change keyup paste click",function(){kirki.setting.set(i.id,jQuery(this).val())})}},textarea:{init:function(i){var e=jQuery('textarea[data-id="'+i.id+'"]');e.on("change keyup paste click",function(){kirki.setting.set(i.id,jQuery(this).val())})}},select:{init:function(i){var e=jQuery('select[data-id="'+i.id+'"]'),a=parseInt(e.data("multiple"),10),t,n={escapeMarkup:function(i){return i}};if(i.params.placeholder){n.placeholder=i.params.placeholder;n.allowClear=true}if(1<a){n.maximumSelectionLength=a}jQuery(e).selectWoo(n).on("change",function(){t=jQuery(this).val();t=null===t&&1<a?[]:t;kirki.setting.set(i.id,t)})}},number:{init:function(a){var t=jQuery('input[data-id="'+a.id+'"]'),i=a.setting._value,e,n;a.params.choices=_.defaults(a.params.choices,{min:0,max:100,step:1});if(isNaN(i)||""===i){i=0>a.params.choices.min&&0<a.params.choices.max?0:a.params.choices.min}i=parseFloat(i);a.params.choices.step="any"===a.params.choices.step?.001:a.params.choices.step;a.params.choices.min=parseFloat(a.params.choices.min);a.params.choices.max=parseFloat(a.params.choices.max);a.params.choices.step=parseFloat(a.params.choices.step);e=jQuery('.kirki-input-container[data-id="'+a.id+'"] .plus');n=jQuery('.kirki-input-container[data-id="'+a.id+'"] .minus');e.click(function(){var i=parseFloat(t.val()),e;e=i>=a.params.choices.max?i:i+a.params.choices.step;t.val(e);t.trigger("change")});n.click(function(){var i=parseFloat(t.val()),e;e=i<=a.params.choices.min?i:i-a.params.choices.step;t.val(e);t.trigger("change")});t.on("change keyup paste click",function(){var i=jQuery(this).val();if(isNaN(i)){i=parseFloat(i,10);i=isNaN(i)?0:i;jQuery(this).attr("value",i)}kirki.setting.set(a.id,i)})}},image:{init:function(n){var e=kirki.setting.get(n.id),s=!_.isUndefined(n.params.choices)&&!_.isUndefined(n.params.choices.save_as)?n.params.choices.save_as:"url",r=n.container.find(".placeholder, .thumbnail"),i="array"===s?e.url:e,c=n.container.find(".image-upload-remove-button"),l=n.container.find(".image-default-button");e="array"===s&&_.isString(e)?{url:e}:e;if(("id"===s||"ID"===s)&&""!==e){wp.media.attachment(e).fetch().then(function(){setTimeout(function(){var i=wp.media.attachment(e).get("url");r.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+i+'" alt="" />')},700)})}if("url"===s&&""!==e||"array"===s&&!_.isUndefined(e.url)&&""!==e.url){n.container.find("image-default-button").hide()}if("url"===s&&""===e||"array"===s&&(_.isUndefined(e.url)||""===e.url)){c.hide()}if(e===n.params.default){n.container.find("image-default-button").hide()}if(""!==i){r.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+i+'" alt="" />')}n.container.on("click",".image-upload-button",function(i){var t=wp.media({multiple:false}).open().on("select",function(){var i=t.state().get("selection").first(),e=i.toJSON(),a=e.url;if(!_.isUndefined(e.sizes)){a=e.sizes.full.url;if(!_.isUndefined(e.sizes.medium)){a=e.sizes.medium.url}else if(!_.isUndefined(e.sizes.thumbnail)){a=e.sizes.thumbnail.url}}if("array"===s){kirki.setting.set(n.id,{id:e.id,url:e.sizes.full.url,width:e.width,height:e.height})}else if("id"===s){kirki.setting.set(n.id,e.id)}else{kirki.setting.set(n.id,!_.isUndefined(e.sizes)?e.sizes.full.url:e.url)}if(r.length){r.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+a+'" alt="" />')}if(c.length){c.show();l.hide()}});i.preventDefault()});n.container.on("click",".image-upload-remove-button",function(i){var e,a,t;i.preventDefault();kirki.setting.set(n.id,"");e=n.container.find(".placeholder, .thumbnail");a=n.container.find(".image-upload-remove-button");t=n.container.find(".image-default-button");if(e.length){e.removeClass().addClass("placeholder").html(kirkiL10n.noFileSelected)}if(a.length){a.hide();if(jQuery(t).hasClass("button")){t.show()}}});n.container.on("click",".image-default-button",function(i){var e,a,t;i.preventDefault();kirki.setting.set(n.id,n.params.default);e=n.container.find(".placeholder, .thumbnail");a=n.container.find(".image-upload-remove-button");t=n.container.find(".image-default-button");if(e.length){e.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+n.params.default+'" alt="" />')}if(a.length){a.show();t.hide()}})}}}});