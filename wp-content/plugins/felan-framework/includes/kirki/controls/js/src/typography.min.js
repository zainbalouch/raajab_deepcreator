wp.customize.controlConstructor["kirki-typography"]=wp.customize.kirkiDynamicControl.extend({initKirkiControl:function(){"use strict";var e=this,t=e.setting._value,i;e.renderFontSelector();e.renderBackupFontSelector();e.renderVariantSelector();if("undefined"!==typeof e.params.default["font-size"]){this.container.on("change keyup paste",".font-size input",function(){e.saveValue("font-size",jQuery(this).val())})}if("undefined"!==typeof e.params.default["line-height"]){this.container.on("change keyup paste",".line-height input",function(){e.saveValue("line-height",jQuery(this).val())})}if("undefined"!==typeof e.params.default["margin-top"]){this.container.on("change keyup paste",".margin-top input",function(){e.saveValue("margin-top",jQuery(this).val())})}if("undefined"!==typeof e.params.default["margin-bottom"]){this.container.on("change keyup paste",".margin-bottom input",function(){e.saveValue("margin-bottom",jQuery(this).val())})}if("undefined"!==typeof e.params.default["letter-spacing"]){t["letter-spacing"]=jQuery.isNumeric(t["letter-spacing"])?t["letter-spacing"]+"px":t["letter-spacing"];this.container.on("change keyup paste",".letter-spacing input",function(){t["letter-spacing"]=jQuery.isNumeric(jQuery(this).val())?jQuery(this).val()+"px":jQuery(this).val();e.saveValue("letter-spacing",t["letter-spacing"])})}if("undefined"!==typeof e.params.default["word-spacing"]){this.container.on("change keyup paste",".word-spacing input",function(){e.saveValue("word-spacing",jQuery(this).val())})}if("undefined"!==typeof e.params.default["text-align"]){this.container.on("change",".text-align input",function(){e.saveValue("text-align",jQuery(this).val())})}if("undefined"!==typeof e.params.default["text-transform"]){jQuery(e.selector+" .text-transform select").selectWoo().on("change",function(){e.saveValue("text-transform",jQuery(this).val())})}if("undefined"!==typeof e.params.default["text-decoration"]){jQuery(e.selector+" .text-decoration select").selectWoo().on("change",function(){e.saveValue("text-decoration",jQuery(this).val())})}if("undefined"!==typeof e.params.default.color){i=this.container.find(".kirki-color-control");i.wpColorPicker({change:function(){setTimeout(function(){e.saveValue("color",i.val())},100)}})}},renderFontSelector:function(){var e=this,t=e.selector+" .font-family select",i=[],a=[],n=[],o=e.setting._value,s=e.getFonts(),r,l;if(!_.isUndefined(s.standard)){_.each(s.standard,function(e){a.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})})}if(!_.isUndefined(s.google)){_.each(s.google,function(e){n.push({id:e.family,text:e.family})})}l={};if(!_.isUndefined(e.params)&&!_.isUndefined(e.params.choices)&&!_.isUndefined(e.params.choices.fonts)&&!_.isUndefined(e.params.choices.fonts.families)){l=e.params.choices.fonts.families}i=jQuery.extend({},l,{default:{text:kirkiL10n.defaultCSSValues,children:[{id:"",text:kirkiL10n.defaultBrowserFamily},{id:"initial",text:"initial"},{id:"inherit",text:"inherit"}]},standard:{text:kirkiL10n.standardFonts,children:a},google:{text:kirkiL10n.googleFonts,children:n}});if(kirkiL10n.isScriptDebug){console.info('Kirki Debug: Font families for control "'+e.id+'":');console.info(i)}i=_.values(i);r=jQuery(t).selectWoo({data:i});if(o["font-family"]||""===o["font-family"]){o["font-family"]=kirki.util.parseHtmlEntities(o["font-family"].replace(/'/g,'"'));r.val(o["font-family"]).trigger("change")}r.on("change",function(){e.saveValue("font-family",jQuery(this).val());e.renderBackupFontSelector();e.renderVariantSelector()})},renderBackupFontSelector:function(){var e=this,t=e.selector+" .font-backup select",i=[],a=e.setting._value,n=a["font-family"],o=e.getFonts(),s;if(_.isUndefined(a["font-backup"])||null===a["font-backup"]){a["font-backup"]=""}if("inherit"===n||"initial"===n||"google"!==kirki.util.webfonts.getFontType(n)){jQuery(e.selector+" .font-backup").hide();return}jQuery(e.selector+" .font-backup").show();if(!_.isUndefined(o.standard)){_.each(o.standard,function(e){i.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})})}s=jQuery(t).selectWoo({data:i});if("undefined"!==typeof a["font-backup"]){s.val(a["font-backup"].replace(/'/g,'"')).trigger("change")}s.on("change",function(){e.saveValue("font-backup",jQuery(this).val())})},renderVariantSelector:function(){var e=this,t=e.setting._value,i=t["font-family"],a=e.selector+" .variant select",n=[],o=false,s=kirki.util.webfonts.getFontType(i),r=["","regular","italic","700","700italic"],l,f,c;if("google"===s){r=kirki.util.webfonts.google.getVariants(i)}if(!_.isUndefined(e.params)&&!_.isUndefined(e.params.choices)&&!_.isUndefined(e.params.choices.fonts)&&!_.isUndefined(e.params.choices.fonts.variants)){if(!_.isUndefined(e.params.choices.fonts.variants[i])){r=e.params.choices.fonts.variants[i]}}if(kirkiL10n.isScriptDebug){console.info('Kirki Debug: Font variants for font-family "'+i+'":');console.info(r)}if("inherit"===i||"initial"===i||""===i){t.variant="inherit";r=[""];jQuery(e.selector+" .variant").hide()}if(1>=r.length){jQuery(e.selector+" .variant").hide();t.variant=r[0];e.saveValue("variant",t.variant);if(""===t.variant||!t.variant){l="";c=""}else{l=!_.isString(t.variant)?"400":t.variant.match(/\d/g);l=!_.isObject(l)?"400":l.join("");c=t.variant&&-1!==t.variant.indexOf("italic")?"italic":"normal"}e.saveValue("font-weight",l);e.saveValue("font-style",c);return}jQuery(e.selector+" .font-backup").show();jQuery(e.selector+" .variant").show();_.each(r,function(e){if(t.variant===e){o=true}n.push({id:e,text:e})});if(!o){t.variant="regular"}if(jQuery(a).hasClass("select2-hidden-accessible")){jQuery(a).selectWoo("destroy");jQuery(a).empty()}f=jQuery(a).selectWoo({data:n});f.val(t.variant).trigger("change");f.on("change",function(){e.saveValue("variant",jQuery(this).val());if("string"!==typeof t.variant){t.variant=r[0]}l=!_.isString(t.variant)?"400":t.variant.match(/\d/g);l=!_.isObject(l)?"400":l.join("");c=-1!==t.variant.indexOf("italic")?"italic":"normal";e.saveValue("font-weight",l);e.saveValue("font-style",c)})},getFonts:function(){var e=this,t=kirki.util.webfonts.google.getFonts(),i={},a="alpha",n=0,o={};if(!_.isEmpty(e.params.choices.fonts.google)){if("alpha"===e.params.choices.fonts.google[0]||"popularity"===e.params.choices.fonts.google[0]||"trending"===e.params.choices.fonts.google[0]){a=e.params.choices.fonts.google[0];if(!isNaN(e.params.choices.fonts.google[1])){n=parseInt(e.params.choices.fonts.google[1],10)}i=kirki.util.webfonts.google.getFonts(a,"",n)}else{_.each(e.params.choices.fonts.google,function(e){if("undefined"!==typeof t[e]&&!_.isEmpty(t[e])){i[e]=t[e]}})}}else{i=kirki.util.webfonts.google.getFonts(a,"",n)}if(!_.isEmpty(e.params.choices.fonts.standard)){_.each(e.params.choices.fonts.standard,function(e){if("undefined"!==typeof kirki.util.webfonts.standard.fonts[e]&&!_.isEmpty(kirki.util.webfonts.standard.fonts[e])){o[e]={};if("undefined"!==kirki.util.webfonts.standard.fonts[e].stack&&!_.isEmpty(kirki.util.webfonts.standard.fonts[e].stack)){o[e].family=kirki.util.webfonts.standard.fonts[e].stack}else{o[e].family=i[e]}if("undefined"!==kirki.util.webfonts.standard.fonts[e].label&&!_.isEmpty(kirki.util.webfonts.standard.fonts[e].label)){o[e].label=kirki.util.webfonts.standard.fonts[e].label}else if(!_.isEmpty(o[e])){o[e].label=o[e]}}else{o[e]={family:e,label:e}}})}else{_.each(kirki.util.webfonts.standard.fonts,function(e,t){o[t]={family:e.stack,label:e.label}})}return{google:i,standard:o}},saveValue:function(e,t){var i=this,a=i.container.find(".typography-hidden-value"),n=i.setting._value;n[e]=t;jQuery(a).attr("value",JSON.stringify(n)).trigger("change");i.setting.set(n)}});