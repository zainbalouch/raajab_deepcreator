wp.customize.controlConstructor["kirki-background"]=wp.customize.Control.extend({ready:function(){"use strict";var n=this;if(!_.isUndefined(window.kirkiControlLoader)&&_.isFunction(kirkiControlLoader)){kirkiControlLoader(n)}else{n.initKirkiControl()}},initKirkiControl:function(){var d=this,n=d.setting._value,e=d.container.find(".kirki-color-control");if(_.isUndefined(n["background-image"])||""===n["background-image"]){d.container.find(".background-wrapper > .background-repeat").hide();d.container.find(".background-wrapper > .background-position").hide();d.container.find(".background-wrapper > .background-size").hide();d.container.find(".background-wrapper > .background-attachment").hide()}e.wpColorPicker({change:function(){setTimeout(function(){d.saveValue("background-color",e.val())},100)}});d.container.on("change",".background-repeat select",function(){d.saveValue("background-repeat",jQuery(this).val())});d.container.on("change click",".background-size input",function(){d.saveValue("background-size",jQuery(this).val())});d.container.on("change",".background-position select",function(){d.saveValue("background-position",jQuery(this).val())});d.container.on("change click",".background-attachment input",function(){d.saveValue("background-attachment",jQuery(this).val())});d.container.on("click",".background-image-upload-button",function(n){var u=wp.media({multiple:false}).open().on("select",function(){var n=u.state().get("selection").first(),e=n.toJSON().sizes.full.url,a,i,o,r,t,c;if(!_.isUndefined(n.toJSON().sizes.medium)){e=n.toJSON().sizes.medium.url}else if(!_.isUndefined(n.toJSON().sizes.thumbnail)){e=n.toJSON().sizes.thumbnail.url}a=n.toJSON().sizes.full.url;i=n.toJSON().id;o=n.toJSON().width;r=n.toJSON().height;if(""!==a){d.container.find(".background-wrapper > .background-repeat, .background-wrapper > .background-position, .background-wrapper > .background-size, .background-wrapper > .background-attachment").show()}d.saveValue("background-image",a);t=d.container.find(".placeholder, .thumbnail");c=d.container.find(".background-image-upload-remove-button");if(t.length){t.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+e+'" alt="" />')}if(c.length){c.show()}});n.preventDefault()});d.container.on("click",".background-image-upload-remove-button",function(n){var e,a;n.preventDefault();d.saveValue("background-image","");e=d.container.find(".placeholder, .thumbnail");a=d.container.find(".background-image-upload-remove-button");d.container.find(".background-wrapper > .background-repeat").hide();d.container.find(".background-wrapper > .background-position").hide();d.container.find(".background-wrapper > .background-size").hide();d.container.find(".background-wrapper > .background-attachment").hide();if(e.length){e.removeClass().addClass("placeholder").html("No file selected")}if(a.length){a.hide()}})},saveValue:function(n,e){var a=this,i=jQuery("#customize-control-"+a.id.replace("[","-").replace("]","")+" .background-hidden-value"),o=a.setting._value;o[n]=e;jQuery(i).attr("value",JSON.stringify(o)).trigger("change");a.setting.set(o)}});