var GLF_GalleryClass=function(e){this.$container=e};(function(f){"use strict";GLF_GalleryClass.prototype={init:function(){this.select();this.remove();this.sortable()},select:function(){var d=new GLFMedia,e=this.$container.find(".glf-gallery-add");d.selectGallery(e,{filter:"image"},function(e){if(e.length){var i=f(d.clickedButton);var a=i.parent();var t=a.find('input[type="hidden"]');var l=t.val();var r=l.split("|");var n="";var s="";e.each(function(e){e=e.toJSON();if(r.indexOf(""+e.id)!=-1){return}if(l!=""){l+="|"+e.id}else{l=""+e.id}r.push(""+e.id);if(e.sizes){if(e.sizes.thumbnail!==undefined)s=e.sizes.thumbnail.url;else if(e.sizes.medium!==undefined)s=e.sizes.medium.url;else s=e.sizes.full.url;n+='<div class="glf-image-preview" data-id="'+e.id+'">';n+='<div class="centered">';n+='<img src="'+s+'"/>';n+="</div>";n+='<span class="glf-gallery-remove dashicons dashicons dashicons-no-alt"></span>';n+="</div>"}});t.val(l);i.before(n);i.trigger("glf-gallery-selected")}})},remove:function(){this.$container.on("click",".glf-gallery-remove",function(){var e=f(this).parent();var i=e.parent();var a=i.find('input[type="hidden"]');e.remove();var t="";f(".glf-image-preview",i).each(function(){if(t!=""){t+="|"+f(this).data("id")}else{t=""+f(this).data("id")}});a.val(t);i.trigger("glf-gallery-removed")})},sortable:function(){this.$container.sortable({placeholder:"glf-gallery-sortable-placeholder",items:".glf-image-preview",update:function(e,i){var a=f(e.target);var t="";f(".glf-image-preview",a).each(function(){if(t!=""){t+="|"+f(this).data("id")}else{t=""+f(this).data("id")}});var l=a.find('input[type="hidden"]');l.val(t);a.trigger("glf-gallery-sortable-updated")}})}}})(jQuery);