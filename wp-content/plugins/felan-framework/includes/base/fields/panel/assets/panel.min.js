var GLF_PanelClass=function(e){this.$container=e};(function($){"use strict";GLF_PanelClass.prototype={init:function(){var e=this;e.toggleElement();e.panelTitleElement()},panelTitleElement:function(){var e=this.$container.find('[data-panel-title="true"]:first');e.on("change",function(){var e=$(this),n=e.val(),l=e.closest(".glf-clone-field-panel").find(".glf-panel-title"),t=l.data("label");if(n==""){l.text(t)}else{l.text(t+": "+n)}});e.trigger("change")},toggleElement:function(e){var n=this.$container.find("> h4"),l=this.$container.find(">.glf-clone-field-panel-inner");n.on("click",function(e){if($(e.target).closest(".glf-clone-button-remove").length==0){n.find(".glf-panel-toggle").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down");l.slideToggle()}})}};var GLF_PanelObject={init:function(){var e=$(".glf-meta-config-wrapper");e=e.length?e:$("body");e.on("glf_make_template_done",function(){$(".glf-clone-field-panel").each(function(){var e=new GLF_PanelClass($(this));e.init()});GLF_PanelObject.sortableFieldPanel();GLF_PanelObject.addCloneButton()})},addCloneButton:function(){$(".glf-field.glf-field-panel").on("glf_add_clone_field",function(event){var $items=$(event.target);if($items.length){var field=new GLF_PanelClass($items);field.init();GLFFieldsConfig.cloneField.makeCloneTemplateElement($items);$items.find(".glf-field").each(function(){var $field=$(this),fieldType=$field.data("field-type");if(typeof fieldType!="undefined"){var $container=$field.find(".glf-field-"+fieldType+"-inner");try{var field=eval("new "+GLF_PanelObject.getFieldClass(fieldType)+"($container)");field.init()}catch(ex){}}});$items.find(".glf-field").each(function(){var e=$(this);e.on("glf_check_required",GLFFieldsConfig.required.onChangeEvent);e.trigger("glf_check_required");e.trigger("glf_check_preset")})}})},getFieldClass:function(e){var n=e.split("_");for(var l=0;l<n.length;l++){n[l]=this.ucwords(n[l])}return"GLF_"+n.join("")+"Class"},ucwords:function(e){return(e+"").replace(/^([a-z])|\s+([a-z])/g,function(e){return e.toUpperCase()})},sortableFieldPanel:function(){var e=this;$(".glf-field-panel-sortable").sortable({placeholder:"glf-field-panel-sortable-placeholder",handle:".glf-field-panel-title",items:".glf-clone-field-panel",update:function(e){var n=$(e.target),l=n.closest(".glf-field");GLFFieldsConfig.cloneField.reIndexFieldName(n.parent(),false);l.trigger("glf_field_change")}})}};$(document).ready(function(){GLF_PanelObject.init();GLFFieldsConfig.fieldInstance.push(GLF_PanelObject)})})(jQuery);