(function(U){"use strict";var z=U("#submit_jobs_form"),e=z.data("titleerror"),a=z.data("deserror"),t=z.data("caterror"),i=z.data("typeerror"),s=z.data("skillserror"),o=z.data("rateerror"),r=z.data("minimumpriceerror"),l=z.data("maximumpriceerror");var F=felan_submit_vars.ajax_url,K=felan_submit_vars.jobs_dashboard,L=felan_submit_vars.custom_field_jobs;U(document).ready(function(){U.validator.setDefaults({ignore:":hidden:not(select)"});U.validator.addMethod("isCityName",function(e,a){var n="ductrung";var t=false;if(e==""){t=true;return t}else{var i="https://secure.geonames.org/searchJSON?q="+encodeURIComponent(e)+"&maxRows=1&username="+n;U.ajax({url:i,method:"GET",dataType:"json",async:false,success:function(e){if(e.geonames&&e.geonames.length>0){var a=e.geonames[0].fclName;if(a.indexOf("city")!=-1){t=true}}},error:function(){console.log("An error occurred while checking the city name.")}});return t}});z.validate({ignore:[],rules:{jobs_title:{required:true},jobs_categories:{required:true},jobs_type:{required:true},jobs_skills:{required:true},jobs_des:{required:true},jobs_new_location:{isCityName:true},jobs_salary_minimum:{required:function(){return U('select[name="jobs_salary_show"]').val()==="range"}},jobs_salary_maximum:{required:function(){return U('select[name="jobs_salary_show"]').val()==="range"}},jobs_salary_rate:{required:function(){const e=U('select[name="jobs_salary_show"]').val();return["starting_amount","range","maximum_amount"].includes(e)}},jobs_minimum_price:{required:function(){return U('select[name="jobs_salary_show"]').val()==="starting_amount"}},jobs_maximum_price:{required:function(){return U('select[name="jobs_salary_show"]').val()==="maximum_amount"}}},messages:{jobs_title:e,jobs_des:a,jobs_categories:t,jobs_type:i,jobs_skills:s,jobs_new_location:{isCityName:"Please enter a valid city name."},jobs_salary_rate:o,jobs_salary_minimum:r,jobs_salary_maximum:l,jobs_minimum_price:r,jobs_maximum_price:l},submitHandler:function(e){var a=U(this.submitButton).attr("name");n(a)},errorPlacement:function(e,a){e.insertAfter(a)},invalidHandler:function(){if(U(".error:visible").length>0){U("html, body").animate({scrollTop:U(".error:visible").offset().top-100},500)}}});function n(a){var e=z.find('input[name="jobs_form"]').val(),n=z.find('input[name="jobs_action"]').val(),t=z.find('input[name="jobs_id"]').val(),i=z.find('input[name="jobs_title"]').val(),s=z.find('select[name="jobs_categories"]').val(),o=z.find('input[name="jobs_new_categories"]').val(),r=z.find('select[name="jobs_type"]').val(),l=z.find('select[name="jobs_skills"]').val(),_=tinymce.get("jobs_des").getContent(),m=z.find('select[name="jobs_career"]').val(),u=z.find('select[name="jobs_experience"]').val(),d=z.find('select[name="jobs_qualification"]').val(),c=z.find('select[name="jobs_quantity"]').val(),f=z.find('select[name="jobs_gender"]').val(),b=z.find('input[name="jobs_days_closing"]').val(),p=z.find('select[name="jobs_salary_show"]').val(),j=z.find('select[name="jobs_currency_type"]').val(),v=z.find('input[name="jobs_salary_minimum"]').val(),g=z.find('input[name="jobs_salary_maximum"]').val(),y=z.find('select[name="jobs_salary_rate"]').val(),h=z.find('input[name="jobs_minimum_price"]').val(),x=z.find('input[name="jobs_maximum_price"]').val(),w=z.find('select[name="jobs_select_apply"]').val(),q=z.find('input[name="jobs_apply_email"]').val(),k=z.find('input[name="jobs_apply_external"]').val(),C=z.find('input[name="jobs_apply_call_to"]').val(),O=z.find('select[name="jobs_select_company"]').val(),T=z.find('select[name="jobs_location"]').val(),N=z.find('input[name="jobs_new_location"]').val(),S=z.find('input[name="jobs_thumbnail_url"]').val(),D=z.find('input[name="jobs_thumbnail_id"]').val(),I=z.find('input[name="felan_gallery_ids[]"]').map(function(){return U(this).val()}).get(),P=z.find('input[name="jobs_video_url"]').val(),H=z.find('input[name="felan_map_address"]').val(),J=z.find('input[name="felan_map_location"]').val(),R=z.find('input[name="felan_latitude"]').val(),B=z.find('input[name="felan_longtitude"]').val(),E=z.find('input[name="company_title"]').val(),G=z.find('input[name="company_email"]').val(),M=z.find('input[name="company_avatar_url"]').val(),Q=z.find('input[name="company_avatar_id"]').val();var A={};U("#jobs-submit-additional").each(function(){U.each(L,function(e,a){var n=U(".form-control[name="+a.id+"]").val();if(a.type=="radio"){n=U("input[name="+a.id+"]:checked").val()}if(a.type=="checkbox_list"){var t=[];U('input[name="'+a.id+'[]"]:checked').each(function(){t.push(U(this).val())});n=t}if(a.type=="image"){n=U("input#custom_image_id_"+a.id).val()}A[a.id]=n})});U.ajax({type:"POST",dataType:"json",url:F,data:{action:"jobs_submit_ajax",jobs_form:e,jobs_action:n,jobs_id:t,jobs_title:i,jobs_categories:s,jobs_new_categories:o,jobs_type:r,jobs_skills:l,jobs_des:_,jobs_career:m,jobs_experience:u,jobs_qualification:d,jobs_quantity:c,jobs_gender:f,jobs_days_closing:b,jobs_salary_show:p,jobs_currency_type:j,jobs_salary_minimum:v,jobs_salary_maximum:g,jobs_salary_rate:y,jobs_minimum_price:h,jobs_maximum_price:x,jobs_select_apply:w,jobs_apply_email:q,jobs_apply_external:k,jobs_apply_call_to:C,jobs_select_company:O,jobs_location:T,jobs_new_location:N,jobs_thumbnail_url:S,jobs_thumbnail_id:D,felan_gallery_ids:I,jobs_video_url:P,custom_field_jobs:A,jobs_map_address:H,jobs_map_location:J,jobs_latitude:R,jobs_longtitude:B,submit_button:a,company_title:E,company_email:G,company_avatar_url:M,company_avatar_id:Q},beforeSend:function(){if(a=="submit_jobs"){U(".btn-submit-jobs .btn-loading").fadeIn()}else{U(".btn-submit-draft .btn-loading").fadeIn()}},success:function(e){if(a=="submit_jobs"){U(".btn-submit-jobs .btn-loading").fadeOut();if(e.success===true){window.location.href=K}}else{U(".btn-submit-draft .btn-loading").fadeOut()}}})}U(".ai-helper").on("click",function(e){e.preventDefault();var a=U(this),n=a.attr("data-popup");U("#"+n).addClass("open")});if(U(window).width()>767){U(".generate-content").each(function(){var e=U(this).find(".left"),a=U(this).find(".right"),n=e.outerHeight();a.css("height",n)})}U(".ai-generate").on("submit",function(e){e.preventDefault();var n=U(this),t=U(this).closest(".ai-popup"),i=t.find(".inner-popup"),a=n.find('textarea[name="ai_prompt"]').val(),s=n.find('select[name="ai_tone"] option:selected').text(),o=n.find('select[name="ai_language"] option:selected').text();U.ajax({url:F,type:"POST",data:{action:"auto_description_generate",keywords:a,tone:s,language:o},beforeSend:function(){n.find(".btn-loading").fadeIn();t.find(".suggestion").text("");n.find(".field-notice").removeClass("error");n.find(".field-notice p").text("");t.find(".generate-content").removeClass("has-suggestion")},success:function(a){var a=U.parseJSON(a);n.find(".btn-loading").fadeOut();if(a.success){n.find(".field-submit button .text").text(felan_submit_vars.regenerate);t.find(".generate-content").addClass("has-suggestion");t.find(".suggestion").html(a.message);if(U(window).width()<768){U(".ai-popup .inner-popup").animate({scrollTop:t.find(".suggestion").offset().top-i.offset().top-40},500)}U(".keep-generate").on("click",function(e){e.preventDefault();tinymce.get("jobs_des").setContent(a.message);t.find(".generate-content").removeClass("has-suggestion");U(".ai-generate")[0].reset();n.closest(".popup").removeClass("open");n.find(".field-submit button .text").text(felan_submit_vars.generate)})}else{n.find(".field-notice p").text(a.message);n.find(".field-notice").addClass("error")}}})})})})(jQuery);