var FELAN_STRIPE=FELAN_STRIPE||{};(function(s){"use strict";FELAN_STRIPE={init:function(){this.setupForm()},setupForm:function(){var e=this,n=s(".felan-service-stripe-form");if(n.length===0)return;var a=n.attr("id");var t=felan_stripe_vars[a];var i=null;var c=n.find(".felan-stripe-button");if(c.length){i=StripeCheckout.configure({key:t.key,locale:"auto",token:function(e,a){s("<input>").attr({type:"hidden",name:"stripeToken",value:e.id}).appendTo(n);s("<input>").attr({type:"hidden",name:"stripeTokenType",value:e.type}).appendTo(n);if(e.email){s("<input>").attr({type:"hidden",name:"stripeEmail",value:e.email}).appendTo(n)}n.submit()}});c.on("click",function(e){e.preventDefault();i.open(t.params)})}window.addEventListener("popstate",function(){if(i!=null){i.close()}})}};s(document).ready(function(){FELAN_STRIPE.init();var e=function(e){if(e=="undefined"||e==""||e==null){e=loading_text}var a=wp.template("felan-processing-template");s("body").append(a({ico:"fa fa-spinner fa-spin",text:e}))};if(typeof felan_payment_vars!=="undefined"){var n=felan_template_vars.ajax_url;s("#felan_payment_service").on("click",function(e){var a=s("input[name='felan_payment_method']:checked").val();var n=s(".payment-wrap").find("input[name='service_id']").val();if(a=="paypal"){t(n)}else if(a=="stripe"){s("#felan_stripe_service_addons button").trigger("click")}else if(a=="wire_transfer"){i(n)}else if(a=="woocheckout"){c(n)}else if(a=="razor"){r(n)}});s('input[name="felan_payment_method"]').on("change",function(){var e=s('input[name="felan_payment_method"]:checked').val();var a=s('input[name="user_demo"]').val();if(a=="yes"){s(".payment-wrap .btn-add-to-message").remove();s(".payment-wrap .btn-submit").remove();if(e=="wire_transfer"){s(".payment-wrap .btn-wrapper").append('<button id="felan_payment_service" type="submit" class="btn btn-success btn-submit gl-button">Pay Now</button>');s("#felan_payment_service").on("click",function(e){var a=s(".payment-wrap").find("input[name='service_id']").val();i(a)})}else{s(".payment-wrap .btn-wrapper").append('<a href="#" class="btn-add-to-message felan-button button-circle" data-text="Oops! Sorry. This action is restricted on the demo site.">Pay Now</a>')}}});var t=function(e){let t=[];s('.package-addons input[type="checkbox"]:checked').each(function(){let e=s(this).siblings("label").find(".title").text();let a=s(this).data("delivery-time");let n=s(this).val();t.push({title:e,deliveryTime:a,value:n})});s.ajax({type:"POST",url:n,data:{action:"felan_paypal_payment_service_addons",service_id:e,felan_service_security_payment:s("#felan_service_security_payment").val(),total_price:s(".package-service").find('input[name="total_price"]').val(),package_time:s(".package-service").find('input[name="package_time"]').val(),package_time_type:s(".package-service").find('input[name="package_time_type"]').val(),package_des:s(".package-service").find('input[name="package_des"]').val(),package_new:s(".package-service").find('input[name="package_new"]').val(),package_addons:t},beforeSend:function(){s("#felan_payment_service").append('<div class="felan-loading-effect"><span class="felan-dual-ring"></span></div>')},success:function(e){window.location.href=e}})};var i=function(e){let t=[];s('.package-addons input[type="checkbox"]:checked').each(function(){let e=s(this).siblings("label").find(".title").text();let a=s(this).data("delivery-time");let n=s(this).val();t.push({title:e,deliveryTime:a,value:n})});s.ajax({type:"POST",url:n,data:{action:"felan_wire_transfer_service_addons",service_id:e,felan_service_security_payment:s("#felan_service_security_payment").val(),price_default:s(".package-service").find('input[name="package_price"]').val(),total_price:s(".package-service").find('input[name="total_price"]').val(),package_time:s(".package-service").find('input[name="package_time"]').val(),package_time_type:s(".package-service").find('input[name="package_time_type"]').val(),package_des:s(".package-service").find('input[name="package_des"]').val(),package_new:s(".package-service").find('input[name="package_new"]').val(),package_addons:t},beforeSend:function(){s("#felan_payment_service").append('<div class="felan-loading-effect"><span class="felan-dual-ring"></span></div>')},success:function(e){window.location.href=e}})};var c=function(e){let t=[];s('.package-addons input[type="checkbox"]:checked').each(function(){let e=s(this).siblings("label").find(".title").text();let a=s(this).data("delivery-time");let n=s(this).val();t.push({title:e,deliveryTime:a,value:n})});s.ajax({type:"POST",url:n,data:{action:"felan_woocommerce_payment_service_addons",service_id:e,felan_service_security_payment:s("#felan_service_security_payment").val(),total_price:s(".package-service").find('input[name="total_price"]').val(),package_time:s(".package-service").find('input[name="package_time"]').val(),package_time_type:s(".package-service").find('input[name="package_time_type"]').val(),package_des:s(".package-service").find('input[name="package_des"]').val(),package_new:s(".package-service").find('input[name="package_new"]').val(),package_addons:t},beforeSend:function(){s("#felan_payment_service").append('<div class="felan-loading-effect"><span class="felan-dual-ring"></span></div>')},success:function(e){window.location.href=e}})};var p=function(e,a){if(typeof a==="undefined"){a=true}var n=document.getElementById(e);if(a===false){n.removeAttribute("disabled")}else{n.setAttribute("disabled",a)}};function r(e){let t=[];s('.package-addons input[type="checkbox"]:checked').each(function(){let e=s(this).siblings("label").find(".title").text();let a=s(this).data("delivery-time");let n=s(this).val();t.push({title:e,deliveryTime:a,value:n})});s.ajax({type:"POST",url:n,data:{action:"felan_razor_service_create_order",service_id:e,felan_service_security_payment:s("#felan_service_security_payment").val(),total_price:s(".package-service").find('input[name="total_price"]').val()},beforeSend:function(){s("#felan_payment_service").append('<div class="felan-loading-effect"><span class="felan-dual-ring"></span></div>')},success:function(a){a=JSON.parse(a);a.modal={ondismiss:function(){p("felan_payment_service",false)}};a.handler=function(e){console.log("payment",e);document.getElementById("razorpay_payment_id").value=e.razorpay_payment_id;document.getElementById("razorpay_signature").value=e.razorpay_signature;s.ajax({url:n,data:{action:"felan_razor_service_payment_verify",razorpay_payment_id:s("#razorpay_payment_id").val(),razorpay_order_id:a.order_id,razorpay_signature:s("#razorpay_signature").val(),package_time:s(".package-service").find('input[name="package_time"]').val(),package_time_type:s(".package-service").find('input[name="package_time_type"]').val(),price_default:s(".package-service").find('input[name="package_price"]').val(),package_des:s(".package-service").find('input[name="package_des"]').val(),package_addons:t,package_new:s(".package-service").find('input[name="package_new"]').val()},type:"POST",success:function(e){if(e){window.location.href=e}}})};l(a)}})}function l(e){var a=new Razorpay(e);a.open()}}})})(jQuery);