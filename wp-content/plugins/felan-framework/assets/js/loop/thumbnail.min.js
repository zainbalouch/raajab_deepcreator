(function (c) {
  "use strict";
  var r = felan_thumbnail_vars.ajax_url,
    t = felan_thumbnail_vars.thumbnail_title,
    o = felan_thumbnail_vars.thumbnail_type,
    s = felan_thumbnail_vars.thumbnail_file_size,
    m = felan_thumbnail_vars.thumbnail_text,
    u = felan_thumbnail_vars.thumbnail_url,
    d = felan_thumbnail_vars.thumbnail_upload_nonce;
  jQuery(document).ready(function () {
    var a = function () {
      var e = new plupload.Uploader({
        browse_button: "felan_select_thumbnail",
        file_data_name: "felan_thumbnail_upload_file",
        drop_element: "felan_thumbnail_view",
        container: "felan_thumbnail_container",
        url: u,
        filters: {
          mime_types: [{ title: t, extensions: o }],
          max_file_size: s,
          prevent_duplicates: true,
        },
      });
      e.init();
      e.bind("UploadProgress", function (a, i) {
        document.getElementById("felan_select_thumbnail").innerHTML =
          '<span><i class="fal fa-spinner fa-spin large"></i></span>';
      });
      e.bind("FilesAdded", function (a, i) {
        a.refresh();
        e.start();
      });
      e.bind("Error", function (a, i) {
        document.getElementById("felan_thumbnail_errors").innerHTML +=
          "Error #" + i.code + ": " + i.message + "<br/>";
      });
      var a = c("#felan_thumbnail_view").data("image-id");
      var i = c("#felan_thumbnail_view").data("image-url");
      if (a && i) {
        var n =
          '<figure class="media-thumb media-thumb-wrap">' +
          '<img src="' +
          i +
          '">' +
          '<div class="media-item-actions">' +
          '<a class="icon icon-thumbnail-delete" data-attachment-id="' +
          a +
          '" href="#" ><i class="far fa-trash-alt large"></i></a>' +
          '<span style="display: none;" class="icon icon-loader"><i class="fal fa-spinner fa-spin large"></i></span>' +
          "</div>" +
          "</figure>";
        c("#felan_thumbnail_view").html(n);
        c("#felan_add_thumbnail").hide();
      }
      e.bind("FileUploaded", function (a, i, e) {
        document.getElementById("felan_drop_thumbnail").style.display = "none";
        var n = c.parseJSON(e.response);
        if (n.success) {
          c("input.thumbnail_url").val(n.full_image);
          c("input.thumbnail_id").val(n.attachment_id);
          var t =
            '<figure class="media-thumb media-thumb-wrap">' +
            '<img src="' +
            n.full_image +
            '">' +
            '<div class="media-item-actions">' +
            '<a class="icon icon-thumbnail-delete" data-attachment-id="' +
            n.attachment_id +
            '" href="#" ><i class="far fa-trash-alt large"></i></a>' +
            '<span style="display: none;" class="icon icon-loader"><i class="fal fa-spinner fa-spin large"></i></span>' +
            "</div>" +
            "</figure>";
          c("#felan_thumbnail_view").html(t);
          l();
          c("#felan_add_thumbnail .la-upload").hide();
          c("#thumbnail_url-error").hide();
          if (c(".form-dashboard").hasClass("freelancer-profile-form")) {
            c("#freelancer-profile-form").find(".point-mark").change();
          }
        }
      });
    };
    a();
    var l = function (o) {
      c("body").on("click", ".icon-thumbnail-delete", function (a) {
        a.preventDefault();
        var i = c(this),
          e = i,
          n = i.closest("#felan_thumbnail_view").find(".media-thumb-wrap"),
          t = i.data("attachment-id"),
          l = c("#felan_drop_thumbnail");
        e.html('<i class="fal fa-spinner fa-spin large"></i>');
        c.ajax({
          type: "post",
          url: r,
          dataType: "json",
          data: {
            action: "felan_thumbnail_remove_ajax",
            attachment_id: t,
            type: o,
            removeNonce: d,
          },
          success: function (a) {
            if (a.success) {
              n.remove();
              n.hide();
              c("#thumbnail_url-error").show();
              c("#felan_add_thumbnail").show();
            }
            e.html('<i class="fal fa-spinner fa-spin large"></i>');
            l.css("display", "block");
            c("#felan_add_thumbnail .la-upload").show();
            c("#felan_select_thumbnail").html(m);
            c("input.thumbnail_url").val("");
            c("input.thumbnail_id").val("");
            if (c(".form-dashboard").hasClass("freelancer-profile-form")) {
              c("#freelancer-profile-form").find(".point-mark").change();
            }
          },
          error: function () {
            e.html('<i class="far fa-trash-alt large"></i>');
          },
        });
      });
    };
    l();
  });
})(jQuery);
