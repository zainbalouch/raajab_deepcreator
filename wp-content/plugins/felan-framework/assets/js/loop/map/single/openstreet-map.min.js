jQuery(document).ready(function () {
  var t = felan_openstreet_map_single_vars.api_key,
    e = parseFloat(felan_openstreet_map_single_vars.lng),
    o = parseFloat(felan_openstreet_map_single_vars.lat),
    a = felan_openstreet_map_single_vars.map_zoom,
    r = felan_openstreet_map_single_vars.map_style,
    i = felan_openstreet_map_single_vars.map_marker;
  var n = jQuery("#openstreetmap_map");
  if (n != null) {
    var s = {
      type: "FeatureCollection",
      features: [
        {
          type: "Feature",
          geometry: { type: "Point", coordinates: [o, e] },
          properties: { iconSize: [48, 48], icon: i },
        },
      ],
    };
    s.features.forEach(function (e, t) {
      e.properties.id = t;
    });
    var p = L.DomUtil.get("openstreetmap_map");
    if (p != null) {
      p._leaflet_id = null;
    }
    var c = new L.map("openstreetmap_map");
    c.on("load", m);
    c.setView([o, e], a);
    function m() {
      var e = "mapbox/" + r;
      L.tileLayer(
        "https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=" +
          t,
        {
          attribution:
            'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
          id: e,
          tileSize: 512,
          zoomOffset: -1,
          accessToken: t,
        }
      ).addTo(c);
      _();
    }
    function l(e) {
      c.flyTo(e.geometry.coordinates, osm_level);
    }
    if (!("remove" in Element.prototype)) {
      Element.prototype.remove = function () {
        if (this.parentNode) {
          this.parentNode.removeChild(this);
        }
      };
    }
    function _() {
      s.features.forEach(function (o) {
        var e = document.createElement("div");
        e.id = "marker-" + o.properties.id;
        e.className = "marker";
        e.style.backgroundImage = "url(" + i + ")";
        e.style.width = o.properties.iconSize[0] + "px";
        e.style.height = o.properties.iconSize[1] + "px";
        var t = L.Icon.extend({
          options: {
            className: "marker-" + o.properties.id,
            iconSize: [40, 40],
            shadowSize: [50, 64],
            iconAnchor: [20, 20],
            shadowAnchor: [4, 62],
            popupAnchor: [0, -12],
          },
        });
        var a = new t({ iconUrl: i });
        new L.marker([o.geometry.coordinates[0], o.geometry.coordinates[1]], {
          icon: a,
        }).addTo(c);
        e.addEventListener("click", function (e) {
          l(o);
          var t = document.getElementsByClassName("active");
          e.stopPropagation();
          if (t[0]) {
            t[0].classList.remove("active");
          }
        });
      });
    }
  }
});
